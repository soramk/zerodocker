<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step 3 è©³ç´°ã‚¬ã‚¤ãƒ‰: Docker Composeã«ã‚ˆã‚‹é€£æº</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: "Compose Orchestration". Background: Warm Neutral. Accents: Compose Orange (#ea580c) & Docker Blue. -->
    <!-- Application Structure Plan: Consistent with previous steps.
         - Key Change: Introduction of "Docker Compose" concepts.
         - Key Change: Multi-container visualization (App + DB).
         - Key Change: Terminal simulates 'docker-compose' commands.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f8fafc;
            color: #334155;
        }
        .font-mono {
            font-family: 'Fira Code', monospace;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 250px;
            max-height: 300px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        .typing-effect {
            overflow: hidden;
            white-space: nowrap;
            border-right: 2px solid transparent;
            animation: typing 2s steps(40, end);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in forwards;
            opacity: 0;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        .step-btn.active {
            background-color: #fff7ed; /* Orange tint for Compose */
            border-left: 4px solid #ea580c;
            color: #9a3412;
        }
        .step-btn {
            border-left: 4px solid transparent;
        }
        /* Architecture Diagram Styles */
        .arch-box {
            transition: all 0.3s ease;
        }
        .arch-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .connection-line {
            height: 4px;
            background: #cbd5e1;
            flex-grow: 1;
            margin: 0 10px;
            position: relative;
        }
        .connection-line::after {
            content: '';
            position: absolute;
            right: 0;
            top: -3px;
            width: 0; 
            height: 0; 
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
            border-left: 10px solid #cbd5e1;
        }
        .connection-line.active {
            background: #22c55e;
            animation: pulseLine 1.5s infinite;
        }
        .connection-line.active::after {
            border-left-color: #22c55e;
        }
        @keyframes pulseLine {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 z-10 flex-none">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <span class="text-3xl">ğŸ™</span>
                <div>
                    <h1 class="text-xl font-bold text-slate-800 leading-none">Step 3: è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’é€£æº</h1>
                    <p class="text-xs text-slate-500 mt-1">Docker Compose & Database é€£æºãƒãƒ³ã‚ºã‚ªãƒ³</p>
                </div>
            </div>
            <div class="hidden md:block">
                <div class="flex items-center space-x-2 text-sm text-slate-500">
                    <span>Progress:</span>
                    <div class="w-32 h-2 bg-slate-100 rounded-full overflow-hidden">
                        <div id="progress-bar" class="h-full bg-orange-500 transition-all duration-500" style="width: 0%"></div>
                    </div>
                    <span id="progress-text">0%</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Workspace -->
    <div class="flex-grow flex flex-col md:flex-row overflow-hidden max-w-7xl mx-auto w-full">
        
        <!-- Sidebar Navigation -->
        <nav class="w-full md:w-64 bg-white border-r border-slate-200 flex-none overflow-y-auto z-0">
            <div class="p-4 space-y-1">
                <button onclick="loadStep(0)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-0">
                    <span>1. ã‚³ãƒ³ã‚»ãƒ—ãƒˆ</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Intro</span>
                </button>
                <button onclick="loadStep(1)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-1">
                    <span>2. ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Edit</span>
                </button>
                <button onclick="loadStep(2)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-2">
                    <span>3. ä¸€æ‹¬èµ·å‹•</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Up</span>
                </button>
                <button onclick="loadStep(3)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-3">
                    <span>4. é€£æºç¢ºèª</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Link</span>
                </button>
                <button onclick="loadStep(4)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-4">
                    <span>5. ä»•çµ„ã¿ã®ç†è§£</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Net</span>
                </button>
                <button onclick="loadStep(5)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-5">
                    <span>6. ä¸€æ‹¬åœæ­¢</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Down</span>
                </button>
            </div>
            
            <div class="p-4 mt-4 border-t border-slate-100">
                <div class="bg-orange-50 p-3 rounded text-sm text-orange-800 border border-orange-200">
                    <p class="font-bold mb-1">ğŸ™ Docker Compose</p>
                    <p id="step-hint">è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ã²ã¨ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§ç®¡ç†ã™ã‚‹é­”æ³•ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</p>
                </div>
            </div>
        </nav>

        <!-- Content Area -->
        <main class="flex-grow bg-slate-50 overflow-y-auto p-4 md:p-8 relative" id="main-content">
            <!-- Dynamic Content injected here -->
        </main>

    </div>

    <!-- Scripts -->
    <script>
        // --- DATA & CONTENT ---
        const tutorialSteps = [
            {
                id: "concept",
                title: "1. ä»Šå›ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³",
                content: `
                    <div class="max-w-3xl mx-auto space-y-8 animate-fade-in">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800 mb-4">ã‚¢ãƒ—ãƒªã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã¤ãªã</h2>
                            <p class="text-lg text-slate-600 mb-6">
                                Step 2ã¾ã§ã¯1ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã ã‘ã§ã—ãŸãŒã€å®Ÿéš›ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ŒWebã‚µãƒ¼ãƒãƒ¼ã€ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ãªã©è¤‡æ•°ã®å½¹å‰²ã§å‹•ãã¾ã™ã€‚<br>
                                ä»Šå›ã¯ã€<strong>Webã‚¢ãƒ—ãƒª(Python)</strong> ã¨ <strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹(Redis)</strong> ã‚’é€£æºã•ã›ãŸã‚¢ã‚¯ã‚»ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ä½œã‚Šã¾ã™ã€‚
                            </p>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 text-center">
                                <div class="text-4xl mb-4">ğŸš«</div>
                                <h3 class="font-bold text-slate-700 mb-2">NGãªã‚„ã‚Šæ–¹</h3>
                                <p class="text-sm text-slate-500">1ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã«Pythonã‚‚DBã‚‚å…¨éƒ¨è©°ã‚è¾¼ã‚€ã€‚<br>(ç®¡ç†ãŒè¤‡é›‘ã§ã€ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ¡ãƒªãƒƒãƒˆãŒå°ç„¡ã—)</p>
                            </div>
                            <div class="bg-orange-50 p-6 rounded-xl shadow-md border border-orange-200 text-center relative">
                                <div class="absolute -top-3 -right-3 bg-orange-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow">æ­£è§£</div>
                                <div class="text-4xl mb-4">ğŸ™</div>
                                <h3 class="font-bold text-orange-800 mb-2">Docker Compose</h3>
                                <p class="text-sm text-orange-800">å½¹å‰²ã”ã¨ã«ã‚³ãƒ³ãƒ†ãƒŠã‚’åˆ†ã‘ã€<br>å°‚ç”¨ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ä¸€æ‹¬ç®¡ç†ã™ã‚‹ã€‚</p>
                            </div>
                        </div>

                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r">
                            <p class="text-blue-800 font-bold">ğŸ› ï¸ ä½œã‚‹ã‚‚ã®: Redisã‚¢ã‚¯ã‚»ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼</p>
                            <p class="text-sm text-blue-700 mt-1">
                                ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ›´æ–°ã™ã‚‹ãŸã³ã«ã€ã€Œè¨ªå•å›æ•°ã€ãŒå¢—ãˆã¦ã„ãã‚¢ãƒ—ãƒªã§ã™ã€‚<br>
                                æ•°å­—ã¯Redisï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰ã«ä¿å­˜ã•ã‚Œã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•ã—ã¦ã‚‚æ¶ˆãˆã¾ã›ã‚“ã€‚
                            </p>
                        </div>

                        <div class="text-center pt-8">
                            <button onclick="loadStep(1)" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-all transform hover:scale-105">
                                è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ã
                            </button>
                        </div>
                    </div>
                `,
                hint: "ã€Œãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã€ã®ç¬¬ä¸€æ­©ã§ã™ã€‚æ©Ÿèƒ½ã”ã¨ã«ã‚³ãƒ³ãƒ†ãƒŠã‚’åˆ†ã‘ã‚‹ã“ã¨ã§ã€äº¤æ›ã‚„ã‚¹ã‚±ãƒ¼ãƒ«ãŒç°¡å˜ã«ãªã‚Šã¾ã™ã€‚"
            },
            {
                id: "code",
                title: "2. é­”æ³•ã®ãƒ•ã‚¡ã‚¤ãƒ« docker-compose.yml",
                content: `
                    <div class="max-w-5xl mx-auto space-y-6 animate-fade-in">
                        <div class="flex justify-between items-end">
                            <div>
                                <h2 class="text-2xl font-bold text-slate-800">composeãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šç¾©</h2>
                                <p class="text-slate-600 mt-2">
                                    æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆä¾‹: <code>my-compose-app</code>ï¼‰ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚<br>
                                    ä»Šå›ã®ä¸»å½¹ã¯ <span class="font-bold text-orange-600">docker-compose.yml</span> ã§ã™ã€‚
                                </p>
                            </div>
                        </div>

                        <div class="grid lg:grid-cols-2 gap-8">
                            <!-- Virtual Editor -->
                            <div class="bg-gray-800 rounded-lg shadow-xl overflow-hidden flex flex-col h-[500px]">
                                <div class="flex bg-gray-900 text-gray-400 text-xs font-mono border-b border-gray-700 overflow-x-auto">
                                    <button onclick="switchTab('compose')" id="tab-compose" class="px-3 py-2 bg-gray-800 text-gray-200 border-t-2 border-orange-500 flex-shrink-0">docker-compose.yml</button>
                                    <button onclick="switchTab('app')" id="tab-app" class="px-3 py-2 hover:bg-gray-700 border-t-2 border-transparent flex-shrink-0">app.py</button>
                                    <button onclick="switchTab('req')" id="tab-req" class="px-3 py-2 hover:bg-gray-700 border-t-2 border-transparent flex-shrink-0">requirements.txt</button>
                                    <button onclick="switchTab('docker')" id="tab-docker" class="px-3 py-2 hover:bg-gray-700 border-t-2 border-transparent flex-shrink-0">Dockerfile</button>
                                </div>
                                <div class="p-4 overflow-auto flex-grow font-mono text-sm text-gray-300 relative group">
                                    <button onclick="copyCode()" class="absolute top-4 right-4 bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded text-xs opacity-0 group-hover:opacity-100 transition-opacity">Copy</button>
                                    <pre id="code-display" class="language-yaml"></pre>
                                </div>
                            </div>

                            <!-- Explanation & Viz -->
                            <div class="space-y-6 flex flex-col">
                                <div id="explanation-box" class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex-grow overflow-y-auto max-h-[300px]">
                                    <!-- Dynamic explanation injected here -->
                                </div>
                                
                                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <h4 class="font-bold text-slate-700 mb-2 text-sm text-center">æ§‹æˆã‚¤ãƒ¡ãƒ¼ã‚¸</h4>
                                    <!-- Simple CSS Architecture Diagram -->
                                    <div class="flex items-center justify-center space-x-4 py-4">
                                        <div class="arch-box bg-blue-100 border-2 border-blue-400 p-3 rounded text-center w-24">
                                            <div class="text-2xl">ğŸ</div>
                                            <div class="text-xs font-bold text-blue-800">web</div>
                                        </div>
                                        <div class="connection-line"></div>
                                        <div class="arch-box bg-red-100 border-2 border-red-400 p-3 rounded text-center w-24">
                                            <div class="text-2xl">ğŸ’¾</div>
                                            <div class="text-xs font-bold text-red-800">redis</div>
                                        </div>
                                    </div>
                                    <p class="text-xs text-center text-slate-400">ã‚¢ãƒ—ãƒªãŒ "redis" ã¨ã„ã†åå‰ã§DBã‚’è¦‹ã¤ã‘ã¾ã™</p>
                                </div>
                            </div>
                        </div>

                        <div class="text-right">
                             <button onclick="loadStep(2)" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors">
                                ãƒ•ã‚¡ã‚¤ãƒ«æº–å‚™OKï¼æ¬¡ã¸ â†’
                            </button>
                        </div>
                    </div>
                `,
                hint: "docker-compose.yml ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆç©ºç™½ï¼‰ã¯ã¨ã¦ã‚‚é‡è¦ã§ã™ï¼ã‚ºãƒ¬ã‚‹ã¨å‹•ãã¾ã›ã‚“ã€‚"
            },
            {
                id: "run",
                title: "3. ä¸€æ‹¬èµ·å‹•ã‚³ãƒãƒ³ãƒ‰",
                content: `
                    <div class="max-w-4xl mx-auto space-y-8 animate-fade-in">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">é­”æ³•ã®ã‚³ãƒãƒ³ãƒ‰: docker-compose up</h2>
                            <p class="text-slate-600 mt-2">
                                ã“ã‚Œã¾ã§ã¯1ã¤ãšã¤ <code>docker run</code> ã—ã¦ã„ã¾ã—ãŸãŒã€ã“ã‚Œã‹ã‚‰ã¯1è¡Œã§å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã§ãã¾ã™ã€‚<br>
                                ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è¨­å®šã‚„èµ·å‹•é †åºã‚‚è‡ªå‹•ã§ç®¡ç†ã—ã¦ãã‚Œã¾ã™ã€‚
                            </p>
                        </div>

                        <!-- Terminal Simulator -->
                        <div class="bg-gray-900 rounded-lg shadow-2xl p-1 border border-gray-700 font-mono text-sm text-gray-300">
                            <div class="flex items-center px-4 py-2 bg-gray-800 rounded-t border-b border-gray-700 mb-2">
                                <div class="flex space-x-2 mr-4">
                                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                </div>
                                <span class="text-xs text-gray-400">Terminal - my-compose-app</span>
                            </div>
                            <div class="p-4 h-80 overflow-y-auto terminal-scroll" id="terminal-output">
                                <div class="mb-2">user@pc:~/my-compose-app$ <span class="animate-pulse">_</span></div>
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                            <h3 class="font-bold text-lg text-orange-700 mb-2">ä¸€æ‹¬ãƒ“ãƒ«ãƒ‰ & èµ·å‹•</h3>
                            <p class="text-sm text-slate-600 mb-4"><code>-d</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã¨ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‹•ãã¾ã™ã€‚</p>
                            <code class="block bg-slate-100 p-2 rounded text-xs mb-4 select-all">docker-compose up -d</code>
                            <button onclick="runTerminal('up')" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-4 rounded flex justify-center items-center shadow-md transition-transform active:scale-95">
                                <span class="mr-2">ğŸš€</span> èµ·å‹•ã™ã‚‹ (Up)
                            </button>
                        </div>
                    </div>
                `,
                hint: "åˆå›ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ãƒ“ãƒ«ãƒ‰ãŒã‚ã‚‹ãŸã‚æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ãŒã€2å›ç›®ã‹ã‚‰ã¯ä¸€ç¬ã§ã™ã€‚"
            },
            {
                id: "verify",
                title: "4. é€£æºå‹•ä½œã®ç¢ºèª",
                content: `
                    <div class="max-w-4xl mx-auto space-y-8 animate-fade-in">
                         <div class="text-center">
                            <h2 class="text-2xl font-bold text-slate-800">ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—</h2>
                            <p class="text-slate-600 mt-2">
                                <a href="#" class="text-blue-600 hover:underline font-mono font-bold">http://localhost:5000</a>
                                ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>
                                æ›´æ–°ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ãŸã³ã«æ•°å­—ãŒå¢—ãˆã‚Œã°ã€Redisã¨ã®é€£æºæˆåŠŸã§ã™ï¼
                            </p>
                        </div>

                        <!-- Virtual Browser -->
                        <div class="bg-slate-200 rounded-lg shadow-xl overflow-hidden border border-slate-300 max-w-2xl mx-auto">
                            <!-- Browser Chrome -->
                            <div class="bg-gray-100 border-b border-gray-300 px-4 py-2 flex items-center space-x-4">
                                <div class="flex space-x-1">
                                    <div class="w-3 h-3 rounded-full bg-red-400"></div>
                                    <div class="w-3 h-3 rounded-full bg-yellow-400"></div>
                                    <div class="w-3 h-3 rounded-full bg-green-400"></div>
                                </div>
                                <div class="flex-grow bg-white rounded-md border border-gray-300 px-3 py-1 text-sm text-gray-600 font-mono flex items-center">
                                    <span class="text-gray-400 mr-2">ğŸ”’</span> localhost:5000
                                </div>
                                <button onclick="refreshBrowser()" class="text-gray-500 hover:text-gray-700 bg-gray-200 hover:bg-gray-300 rounded px-2 transition-colors">â†» æ›´æ–°</button>
                            </div>
                            
                            <!-- Browser Viewport -->
                            <div id="browser-viewport" class="bg-white h-[300px] w-full flex flex-col items-center justify-center pt-10 transition-opacity duration-200">
                                <!-- Content injected via JS -->
                                <div class="text-center p-8">
                                    <p class="text-xl text-slate-500 mb-2">Hello World! I have been seen</p>
                                    <h1 class="text-6xl font-bold text-orange-500 mb-4" id="visit-count">1</h1>
                                    <p class="text-xl text-slate-500">times.</p>
                                </div>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-green-50 border border-green-100 p-4 rounded-xl">
                                <h3 class="font-bold text-green-800 mb-2">âœ… Webã‚¢ãƒ—ãƒª (Python)</h3>
                                <p class="text-xs text-green-700">ã‚ãªãŸãŒã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã®ã¯ã“ã“ã€‚è¡¨ç¤ºã‚’æ‹…å½“ã€‚</p>
                            </div>
                            <div class="bg-red-50 border border-red-100 p-4 rounded-xl">
                                <h3 class="font-bold text-red-800 mb-2">âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ (Redis)</h3>
                                <p class="text-xs text-red-700">æ•°å­—ã‚’è¦šãˆã¦ã„ã‚‹ã®ã¯ã“ã“ã€‚è£æ–¹æ‹…å½“ã€‚</p>
                            </div>
                        </div>

                        <div class="text-center mt-4">
                            <button onclick="loadStep(4)" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors">
                                æ¬¡ã¸ï¼šãªãœç¹‹ãŒã‚‹ã®ã‹ï¼Ÿ
                            </button>
                        </div>
                    </div>
                `,
                hint: "ã“ã‚ŒãŒã€Œã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ã€ãªã‚¢ãƒ—ãƒªã®åŸºæœ¬ã§ã™ã€‚ã‚¢ãƒ—ãƒª(Web)ã¯è¨ˆç®—ã™ã‚‹ã ã‘ã€ãƒ‡ãƒ¼ã‚¿(Redis)ã¯è¨˜æ†¶ã™ã‚‹ã ã‘ã€‚"
            },
            {
                id: "net",
                title: "5. ä»•çµ„ã¿ã®ç†è§£ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰",
                content: `
                    <div class="max-w-4xl mx-auto space-y-6 animate-fade-in">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">Dockerã®é­”æ³•ï¼šåå‰è§£æ±º</h2>
                            <p class="text-slate-600 mt-2">
                                ãªãœPythonã‚³ãƒ¼ãƒ‰ã®ä¸­ã§ <code>host="redis"</code> ã¨æ›¸ãã ã‘ã§ç¹‹ãŒã£ãŸã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ<br>
                                Docker ComposeãŒ<strong>å°‚ç”¨ã®ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</strong>ã‚’è‡ªå‹•ã§ä½œã£ã¦ãã‚Œã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚
                            </p>
                        </div>

                        <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                            <h3 class="font-bold text-center text-slate-700 mb-6">ã‚³ãƒ³ãƒ†ãƒŠé–“é€šä¿¡ã®ã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
                            
                            <!-- SVG Diagram -->
                            <div class="w-full overflow-hidden">
                                <svg viewBox="0 0 600 320" class="w-full h-auto max-w-lg mx-auto" xmlns="http://www.w3.org/2000/svg">
                                    <!-- Network Boundary -->
                                    <rect x="50" y="60" width="500" height="180" rx="15" fill="#f8fafc" stroke="#94a3b8" stroke-width="2" stroke-dasharray="8,4" />
                                    <text x="70" y="90" font-family="sans-serif" font-size="14" fill="#64748b" font-weight="bold">Docker Network (Internal)</text>

                                    <!-- Web Container -->
                                    <g transform="translate(100, 130)">
                                        <rect width="120" height="80" rx="8" fill="#dbeafe" stroke="#2563eb" stroke-width="2" />
                                        <text x="60" y="35" text-anchor="middle" font-size="24">ğŸ</text>
                                        <text x="60" y="60" text-anchor="middle" font-family="sans-serif" font-size="14" font-weight="bold" fill="#1e3a8a">web</text>
                                    </g>

                                    <!-- Redis Container -->
                                    <g transform="translate(380, 130)">
                                        <rect width="120" height="80" rx="8" fill="#fee2e2" stroke="#dc2626" stroke-width="2" />
                                        <text x="60" y="35" text-anchor="middle" font-size="24">ğŸ’¾</text>
                                        <text x="60" y="60" text-anchor="middle" font-family="sans-serif" font-size="14" font-weight="bold" fill="#991b1b">redis</text>
                                    </g>

                                    <!-- Connection Arrow (Internal) -->
                                    <path d="M 220 170 L 370 170" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)" />
                                    <rect x="240" y="155" width="110" height="30" rx="4" fill="#fff" stroke="#cbd5e1" />
                                    <text x="295" y="175" text-anchor="middle" font-family="monospace" font-size="12" fill="#475569">host="redis"</text>

                                    <!-- External Access -->
                                    <path d="M 160 290 L 160 220" stroke="#2563eb" stroke-width="3" marker-end="url(#arrowhead-blue)" />
                                    <text x="160" y="310" text-anchor="middle" font-family="sans-serif" font-size="12" fill="#2563eb" font-weight="bold">localhost:5000</text>
                                    
                                    <!-- Blocked Access -->
                                    <path d="M 440 290 L 440 230" stroke="#ef4444" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrowhead-red)" />
                                    <text x="440" y="310" text-anchor="middle" font-family="sans-serif" font-size="12" fill="#ef4444">Access Blocked</text>
                                    <text x="440" y="270" text-anchor="middle" font-size="16">âŒ</text>

                                    <!-- Definitions -->
                                    <defs>
                                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                                        </marker>
                                        <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#2563eb" />
                                        </marker>
                                        <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444" />
                                        </marker>
                                    </defs>
                                </svg>
                            </div>
                        </div>

                        <div class="bg-yellow-50 p-4 rounded-xl border border-yellow-200 text-sm text-yellow-800">
                            <strong>ãƒã‚¤ãƒ³ãƒˆ:</strong><br>
                            <code>docker-compose.yml</code> ã«æ›¸ã„ãŸã‚µãƒ¼ãƒ“ã‚¹åï¼ˆweb, redisï¼‰ãŒã€ãã®ã¾ã¾ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ›ã‚¹ãƒˆåã«ãªã‚Šã¾ã™ã€‚<br>
                            IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã‚ŒãŒDocker Composeã®æœ€å¤§ã®åˆ©ç‚¹ã®ä¸€ã¤ã§ã™ã€‚
                        </div>

                        <div class="text-center mt-4">
                            <button onclick="loadStep(5)" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors">
                                ãŠç‰‡ä»˜ã‘ã¸
                            </button>
                        </div>
                    </div>
                `,
                hint: "Redisã‚³ãƒ³ãƒ†ãƒŠã¯ `ports` ã‚’å®šç¾©ã—ã¦ã„ã¾ã›ã‚“ã€‚ã¤ã¾ã‚Šã€å¤–éƒ¨ï¼ˆã‚ãªãŸã®PCï¼‰ã‹ã‚‰ã¯ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã§ããšã€Webã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã—ã‹è§¦ã‚Œãªã„å®‰å…¨ãªçŠ¶æ…‹ã§ã™ã€‚"
            },
            {
                id: "done",
                title: "6. ä¸€æ‹¬åœæ­¢ã¨ãŠç‰‡ä»˜ã‘",
                content: `
                    <div class="max-w-3xl mx-auto space-y-8 animate-fade-in">
                        <div class="text-center">
                            <h2 class="text-2xl font-bold text-slate-800">åº—ã˜ã¾ã„ã‚‚ä¸€ç¬ã§</h2>
                            <p class="text-slate-600 mt-2">
                                <code>up</code> ã§å…¨ã¦èµ·å‹•ã—ãŸã‚ˆã†ã«ã€<code>down</code> ã§å…¨ã¦åœæ­¢ãƒ»å‰Šé™¤ã§ãã¾ã™ã€‚<br>
                                ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚‚è‡ªå‹•ã§ãŠæƒé™¤ã•ã‚Œã¾ã™ã€‚
                            </p>
                        </div>

                        <!-- Terminal Simulator -->
                        <div class="bg-gray-900 rounded-lg shadow-lg border border-gray-700 font-mono text-sm text-gray-300 p-1">
                            <div class="flex items-center px-4 py-2 bg-gray-800 rounded-t border-b border-gray-700 mb-2">
                                <span class="text-xs text-gray-400">Terminal</span>
                            </div>
                            <div class="p-4 space-y-2">
                                <div class="flex items-center">
                                    <span class="mr-2 text-green-400">$</span>
                                    <span class="text-white">docker-compose down</span>
                                </div>
                                <div class="text-gray-400 pl-4 border-l-2 border-gray-700 text-xs py-2">
                                    <div class="text-orange-400">Stopping my-compose-app_web_1 ... done</div>
                                    <div class="text-orange-400">Stopping my-compose-app_redis_1 ... done</div>
                                    <div class="text-red-400">Removing my-compose-app_web_1 ... done</div>
                                    <div class="text-red-400">Removing my-compose-app_redis_1 ... done</div>
                                    <div class="text-blue-400">Removing network my-compose-app_default</div>
                                </div>
                                <div class="flex items-center">
                                    <span class="mr-2 text-green-400">$</span>
                                    <span class="animate-pulse">_</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-r from-orange-500 to-red-500 text-white p-8 rounded-xl text-center shadow-lg">
                            <h3 class="text-2xl font-bold mb-4">Step 3 Clear! ğŸ‰</h3>
                            <p class="mb-6 opacity-90">
                                ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼<br>
                                ã“ã‚Œã§ã€Œè¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’é€£æºã•ã›ã¦ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã‚‹ã€åŸºç¤ãŒèº«ã«ã¤ãã¾ã—ãŸã€‚<br>
                                å®Ÿå‹™ã®é–‹ç™ºç’°å¢ƒã®9å‰²ã¯ã€ã“ã® <code>docker-compose up</code> ã§å‹•ã„ã¦ã„ã¾ã™ã€‚
                            </p>
                            <div class="flex justify-center gap-4">
                                <a href="../Step4/Step4_Docker_Tutorial.html" class="inline-block bg-white text-orange-600 font-bold py-3 px-8 rounded-full shadow-lg transition-transform hover:scale-105">
                                    Step 4 ã¸ (é–‹ç™ºç’°å¢ƒ)
                                </a>
                            </div>
                        </div>
                    </div>
                `,
                hint: "docker-compose down ã¯ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã—ã¾ã™ãŒã€ãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼ˆDBã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜é ˜åŸŸï¼‰ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æ®‹ã‚Šã¾ã™ã€‚å®Œå…¨ã«æ¶ˆã™ãªã‚‰ -v ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¾ã™ã€‚"
            }
        ];

        const codeSnippets = {
            compose: `version: '3'
services:
  # 1ã¤ç›®ã®ã‚µãƒ¼ãƒ“ã‚¹: Webã‚¢ãƒ—ãƒª
  web:
    build: .
    ports:
      - "5000:5000"
  
  # 2ã¤ç›®ã®ã‚µãƒ¼ãƒ“ã‚¹: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
  redis:
    image: "redis:alpine"
    # ãƒãƒ¼ãƒˆæŒ‡å®šãªã— = å†…éƒ¨ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½`,
            
            app: `import time
import redis
from flask import Flask

app = Flask(__name__)
# ãƒ›ã‚¹ãƒˆåã«ã‚µãƒ¼ãƒ“ã‚¹å "redis" ã‚’æŒ‡å®šï¼
cache = redis.Redis(host='redis', port=6379)

@app.route('/')
def hello():
    count = get_hit_count()
    return 'Hello World! I have been seen {} times.'.format(count)

def get_hit_count():
    # Redisã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—
    return cache.incr('hits')

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)`,
            
            req: `flask
redis`,
            
            docker: `FROM python:3.9-alpine
WORKDIR /code
# gccãªã©ã‚’è¿½åŠ  (alpineã§pythonå‹•ã‹ã™ãŸã‚ã®ãŠã¾ã˜ãªã„)
RUN apk add --no-cache gcc musl-dev linux-headers
COPY requirements.txt requirements.txt
RUN pip install -r requirements.txt
COPY . .
CMD ["python", "app.py"]`
        };

        const explanations = {
            compose: `
                <h3 class="font-bold text-orange-600 mb-2">docker-compose.yml</h3>
                <p class="text-sm text-slate-600 mb-2">
                    ã“ã“ã§ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®æ§‹æˆã‚’å®šç¾©ã—ã¾ã™ã€‚
                </p>
                <ul class="list-disc list-inside text-xs text-slate-600 space-y-1">
                    <li><span class="font-bold">services:</span> ã‚³ãƒ³ãƒ†ãƒŠã®å®šç¾©ä¸€è¦§ã€‚ã“ã“ã§ã¯ <code>web</code> ã¨ <code>redis</code> ã¨ã„ã†åå‰ã‚’ä»˜ã‘ã¾ã—ãŸã€‚</li>
                    <li><span class="font-bold">web:</span> ç¾åœ¨ã®ãƒ•ã‚©ãƒ«ãƒ€(.)ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚</li>
                    <li><span class="font-bold">redis:</span> Docker Hubã‹ã‚‰æ—¢å­˜ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŒã£ã¦ãã¦ãã®ã¾ã¾ä½¿ã„ã¾ã™ã€‚</li>
                </ul>
            `,
            app: `
                <h3 class="font-bold text-yellow-600 mb-2">app.py</h3>
                <p class="text-sm text-slate-600 mb-2">
                    Pythonã‚³ãƒ¼ãƒ‰ã§ã™ã€‚é‡è¦ãªã®ã¯ <code>host='redis'</code> ã®éƒ¨åˆ†ã€‚
                </p>
                <div class="text-xs bg-yellow-50 p-2 rounded border border-yellow-100 text-yellow-800">
                    Docker Composeå†…ã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹åãŒãã®ã¾ã¾ãƒ›ã‚¹ãƒˆåã¨ã—ã¦ä½¿ãˆã¾ã™ã€‚IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’çŸ¥ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
                </div>
            `,
            req: `
                <h3 class="font-bold text-slate-600 mb-2">requirements.txt</h3>
                <p class="text-sm text-slate-600">
                    Redisã«æ¥ç¶šã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª <code>redis</code> ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚
                </p>
            `,
            docker: `
                <h3 class="font-bold text-blue-700 mb-2">Dockerfile</h3>
                <p class="text-sm text-slate-600 mb-2">
                    Webã‚¢ãƒ—ãƒªç”¨ã®ã‚³ãƒ³ãƒ†ãƒŠè¨­è¨ˆå›³ã§ã™ã€‚Redisã‚³ãƒ³ãƒ†ãƒŠã«ã¯Dockerfileã¯ä¸è¦ã§ã™ï¼ˆæ—¢è£½å“ã‚’ä½¿ã†ãŸã‚ï¼‰ã€‚
                </p>
            `
        };

        // --- APP STATE ---
        let currentStep = 0;
        let visitCount = 1;

        // --- FUNCTIONS ---
        function loadStep(index) {
            currentStep = index;
            
            // Update UI Buttons
            document.querySelectorAll('.step-btn').forEach((btn, idx) => {
                if (idx === index) {
                    btn.classList.add('active');
                    btn.classList.remove('text-slate-600');
                    btn.classList.add('text-orange-700');
                } else {
                    btn.classList.remove('active');
                    btn.classList.add('text-slate-600');
                    btn.classList.remove('text-orange-700');
                }
            });

            // Update Progress Bar
            const progress = Math.round(((index) / (tutorialSteps.length - 1)) * 100);
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('progress-text').innerText = `${progress}%`;

            // Inject Content
            const container = document.getElementById('main-content');
            container.innerHTML = tutorialSteps[index].content;
            document.getElementById('step-hint').innerText = tutorialSteps[index].hint;

            // Step-specific initializations
            if (index === 1) { // Code Step
                setTimeout(() => {
                    switchTab('compose');
                }, 100);
            }
            // Reset count if verifying
            if (index === 3) {
                visitCount = 1;
            }
        }

        function switchTab(type) {
            const display = document.getElementById('code-display');
            const explain = document.getElementById('explanation-box');
            
            // Reset Tabs
            ['compose', 'app', 'req', 'docker'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if(btn) {
                    btn.classList.remove('bg-gray-800', 'text-gray-200');
                    btn.classList.add('hover:bg-gray-700');
                    btn.style.borderTopColor = 'transparent';
                }
            });

            // Activate Tab
            const activeBtn = document.getElementById(`tab-${type}`);
            activeBtn.classList.add('bg-gray-800', 'text-gray-200');
            activeBtn.classList.remove('hover:bg-gray-700');
            
            // Set Color based on type
            let color = '#ea580c'; // default orange (compose)
            if (type === 'app') color = '#eab308'; // yellow
            if (type === 'req') color = '#64748b'; // slate
            if (type === 'docker') color = '#3b82f6'; // blue
            activeBtn.style.borderTopColor = color;

            display.textContent = codeSnippets[type];
            explain.innerHTML = explanations[type];
            
            // Highlight language class update
            let langClass = 'language-yaml';
            if (type === 'app' || type === 'req') langClass = 'language-python';
            if (type === 'docker') langClass = 'language-dockerfile';
            display.className = langClass;
        }

        function copyCode() {
            const code = document.getElementById('code-display').innerText;
            navigator.clipboard.writeText(code);
            alert("ã‚³ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        }

        function runTerminal(action) {
            const terminal = document.getElementById('terminal-output');
            
            if (action === 'up') {
                const logs = [
                    "Creating network \"my-compose-app_default\" with the default driver",
                    "Building web",
                    "Step 1/6 : FROM python:3.9-alpine",
                    " ---> 123456abcdef",
                    "...",
                    "Successfully built 7890abcdef12",
                    "Creating my-compose-app_redis_1 ... done",
                    "Creating my-compose-app_web_1   ... done",
                    "Attaching to my-compose-app_redis_1, my-compose-app_web_1",
                    "redis_1  | 1:C 01 Jan 2024 00:00:00.000 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo",
                    "redis_1  | 1:M 01 Jan 2024 00:00:00.000 * Ready to accept connections",
                    "web_1    |  * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)"
                ];
                
                terminal.innerHTML += `<div class="text-green-400 mb-1">$ docker-compose up -d</div>`;
                
                let delay = 0;
                logs.forEach((log, i) => {
                    let colorClass = 'text-gray-400';
                    if (log.startsWith("redis_1")) colorClass = 'text-red-300';
                    if (log.startsWith("web_1")) colorClass = 'text-blue-300';
                    if (log.includes("done")) colorClass = 'text-green-300';

                    delay += 200;
                    setTimeout(() => {
                        terminal.innerHTML += `<div class="${colorClass} text-xs">${log}</div>`;
                        terminal.scrollTop = terminal.scrollHeight;
                    }, delay);
                });

                setTimeout(() => {
                    terminal.innerHTML += `<div class="mb-2 mt-2">user@pc:~/my-compose-app$ <span class="animate-pulse">_</span></div>`;
                    terminal.scrollTop = terminal.scrollHeight;
                    alert("ã‚³ãƒ³ãƒ†ãƒŠç¾¤ãŒèµ·å‹•ã—ã¾ã—ãŸï¼æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§é€£æºã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚");
                }, delay + 500);
            }
        }

        function refreshBrowser() {
            const viewport = document.getElementById('browser-viewport');
            const countEl = document.getElementById('visit-count');
            
            // Pulse effect
            viewport.style.opacity = '0.7';
            setTimeout(() => {
                viewport.style.opacity = '1';
                visitCount++;
                countEl.innerText = visitCount;
                
                // Animate connecting lines logic (conceptual visual feedback)
                // In a real app we might animate the diagram here too
            }, 200);
        }

        // --- INIT ---
        window.onload = () => {
            loadStep(0);
        };

    </script>
</body>
</html>